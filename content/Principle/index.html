<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>原理分析 | blogs</title>
    <meta name="description" content="专注于前端技术的总结，努力做一名知识的传播者">
    <meta name="generator" content="VitePress v1.1.0">
    <link rel="preload stylesheet" href="/blogs/assets/style.DvIeaDTE.css" as="style">
    
    <script type="module" src="/blogs/assets/app.BIV_SSCJ.js"></script>
    <link rel="preload" href="/blogs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blogs/assets/chunks/framework.BXe616E8.js">
    <link rel="modulepreload" href="/blogs/assets/chunks/theme.ywOF6LqZ.js">
    <link rel="modulepreload" href="/blogs/assets/content_Principle_index.md.CY8QzGay.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar has-sidebar top" data-v-ae24b3ad data-v-ccf7ddec><div class="wrapper" data-v-ccf7ddec><div class="container" data-v-ccf7ddec><div class="title" data-v-ccf7ddec><div class="VPNavBarTitle has-sidebar" data-v-ccf7ddec data-v-ab179fa1><a class="title" href="/blogs/" data-v-ab179fa1><!--[--><!--]--><!----><span data-v-ab179fa1>blogs</span><!--[--><!--]--></a></div></div><div class="content" data-v-ccf7ddec><div class="content-body" data-v-ccf7ddec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ccf7ddec><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ccf7ddec data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>关于我</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://canuse-ui.github.io/canuse" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->组件库<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-ccf7ddec data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ccf7ddec data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ccf7ddec data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ccf7ddec data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-ccf7ddec><div class="divider-line" data-v-ccf7ddec></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-267dd0ed><button data-v-267dd0ed>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-575e6a36><div class="curtain" data-v-575e6a36></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-575e6a36><span class="visually-hidden" id="sidebar-aria-label" data-v-575e6a36> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 has-active" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>show all page</h2><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/guide/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/JavaScript/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>JavaScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Css/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>CSS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Vue/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Vue</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/React/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>React</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Webpack/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Webpack</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Electron/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Electron</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Http/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>HTTP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Concept/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>概念详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Principle/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>原理分析</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Performance/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>性能优化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Problem/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>疑难杂症</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>源码</h3><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Source/Javascript/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Javascript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Source/Vue/Vue2/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Vue2源码学习</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Source/Vue/Internal/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>vue内部运行机制</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>工具</h3><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Tools/Picgo/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>PicGo图床</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Tools/CICD/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>CI/CD</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/blogs/content/Tools/BTQL/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>宝塔面板+青龙面板</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-935f8a84><div class="content" data-v-935f8a84><div class="outline-marker" data-v-935f8a84></div><div class="outline-title" role="heading" aria-level="2" data-v-935f8a84>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-935f8a84><span class="visually-hidden" id="doc-outline-aria-label" data-v-935f8a84> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-935f8a84 data-v-b933a997><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _blogs_content_Principle_" data-v-39a288b8><div><h1 id="原理分析" tabindex="-1">原理分析 <a class="header-anchor" href="#原理分析" aria-label="Permalink to &quot;原理分析&quot;">​</a></h1><h2 id="_1-webpack-热更新原理" tabindex="-1">1 webpack 热更新原理 <a class="header-anchor" href="#_1-webpack-热更新原理" aria-label="Permalink to &quot;1 webpack 热更新原理&quot;">​</a></h2><ul><li>当修改了一个或多个文件；</li><li>文件系统接收更改并通知 <code>webpack</code>；</li><li><code>webpack</code> 重新编译构建一个或多个模块，并通知 <code>HMR</code> 服务器进行更新；</li><li><code>HMR Server</code> 使用 <code>webSocket</code> 通知 <code>HMR runtime</code> 需要更新，<code>HMR</code> 运行时通过 <code>HTTP</code> 请求更新 <code>jsonp</code></li><li><code>HMR</code> 运行时替换更新中的模块，如果确定这些模块无法更新，则触发整个页面刷新。</li></ul><h2 id="_2-webpack-打包原理" tabindex="-1">2 webpack 打包原理 <a class="header-anchor" href="#_2-webpack-打包原理" aria-label="Permalink to &quot;2 webpack 打包原理&quot;">​</a></h2><p><code>webpack</code> 是由 <code>nodejs</code> 编写的前端资源加载/打包工具，由 <code>nodejs</code> 提供了强大的文件处理，<code>IO</code> 能力。</p><p><strong>webpack 的打包原理</strong></p><ul><li>识别入口文件</li><li>通过逐层识别模块依赖（Commonjs、amd 或者 es6 的 import，webpack 都会对其进行分析，来获取代码的依赖）</li><li><code>webpack</code> 做的就是分析代码，转换代码，编译代码，输出代码。</li><li>最终形成打包后的代码</li></ul><p><strong>loader</strong></p><p>loader 是文件加载器，能够加载资源文件，并对这些文件进行一些处理，诸如编译、压缩等，最终一起打包到指定的文件中</p><ul><li><p>处理一个文件可以使用多个 loader，loader 的执行顺序和配置中的顺序是相反的，即最后一个 loader 最先执行，第一个 loader 最后执行</p></li><li><p>第一个执行的 loader 接收源文件内容作为参数，其它 loader 接收前一个执行的 loader 的返回值作为参数，最后执行的 loader 会返回此模块的 Javascript 源码</p></li></ul><p><strong>plugin</strong></p><p>在 webpack 运行的生命周期中会广播出许多事件，plugin可以监听这些事件，在合适的时机通过 webpack 提供的 API 改变输出结果。</p><p><strong>loader 和 plugin 的区别</strong></p><p><code>loader</code>， 它是一个转换器，将 <code>A</code> 文件进行编译成 <code>B</code> 文件，比如：将 <code>A.less</code> 转换为 <code>A.css</code>, 单纯的文件转换过程。</p><p><code>plugin</code> 是一个扩展器，它丰富了 <code>webpack</code> 本身，针对是 <code>loader</code> 结束后， <code>webpack</code> 打包的整个过程，它并不直接操作文件，而是基于事件机制工作，会监听 <code>webpack</code> 打包过程中的某些节点，执行广泛的任务</p><h2 id="_3-react-和-vue-的-diff-时间复杂度-从-o-n-3-优化到-o-n-的原理" tabindex="-1">3 React 和 Vue 的 diff 时间复杂度 从 O(n^3) 优化到 O(n)的原理 <a class="header-anchor" href="#_3-react-和-vue-的-diff-时间复杂度-从-o-n-3-优化到-o-n-的原理" aria-label="Permalink to &quot;3 React 和 Vue 的 diff 时间复杂度 从 O(n^3) 优化到 O(n)的原理&quot;">​</a></h2><p><strong>它们做了三种优化来降低复杂度：</strong></p><ul><li>如果父节点不同，放弃对子节点的比较，直接删除旧节点然后添加新的节点重新渲染；</li><li>如果子节点有变化，<code>Virtual DOM</code> 不会计算变化的是什么，而是重新渲染；</li><li>通过唯一的 <code>key</code> 策略</li></ul><h2 id="_4-vue-中的-computed-是如何实现的" tabindex="-1">4 Vue 中的 computed 是如何实现的 <a class="header-anchor" href="#_4-vue-中的-computed-是如何实现的" aria-label="Permalink to &quot;4 Vue 中的 computed 是如何实现的&quot;">​</a></h2><p><code>computed</code> 本身是通过代理的方式代理到组件实例上的，所以读取计算属性的时候，执行的是一个内部的 <code>getter</code>, 而不是用户定义的方法。</p><p><code>computed</code> 内部实现了一个惰性的 <code>watcher</code>，在实例化的时候不会去求值，其内部通过 <code>dirty</code> 属性标记计算属性是否需要重新求值。当 <code>computed</code> 依赖的任一状态（不一定是 <code>return</code> 中的）发生变化，都会通知这个惰性 <code>watcher</code>，让它把 <code>dirty</code> 属性设置为 <code>true</code>。 所以，当再次读取这个计算属性的时候，就会重新去求值。</p><h2 id="_5-nexttick-原理分析" tabindex="-1">5 NextTick 原理分析 <a class="header-anchor" href="#_5-nexttick-原理分析" aria-label="Permalink to &quot;5 NextTick 原理分析&quot;">​</a></h2><blockquote><p><code>$nextTick</code> 可以让我们在下次 <code>DOM</code> 更新循环结束之后执行延迟回调，用于获得更新后的 <code>DOM</code>。</p></blockquote><p>由于Vue DOM 更新是异步执行的， 即修改数据时，视图不会立即更新，而是会监听数据变化，并缓存在同一事件循环中，等同一数据循环中的所有数据变化完成之后，再统一进行视图更新。为了确保得到更新后的DOM，所以设置了 <code>Vue.nextTick()</code> 方法。</p><p><strong>MutationObserver</strong></p><p><code>MutationObserver</code> 是 HTML5 新增的属性，用于监听 DOM 修改事件，能够监听到节点的属性、文本内容、子节点等的改动。</p><p>调用过程是要先给它绑定回调，得到 MO 实例，这个回调会在 MO 实例监听到变动时触发。 这里 MO 的回调是放在 microtask 中执行的。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 创建 MO 实例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> observer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MutationObserver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(callback)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> textNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;想要监听的 DOM 节点&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  observer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">observe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(textNode, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    characterData: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 说明监听文本内容的修改</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span></code></pre></div><p>在 Vue 2.4 之前都是使用的 <code>microtasks</code>，但是 <code>microtasks</code> 的优先级过高，在某些情况下可能会出现比事件冒泡更快的情况， 但如果都使用 <code>macrotasks</code> 又可能会出现渲染的性能问题。所以在新版本中，又默认使用 <code>microtasks</code>, 但在特殊情况下会使用 <code>macrotasks</code>，比如：<code>v-on</code>。</p><p>对于实现 <code>macrotasks</code>， 会先判断是否能使用 <code>setImmediate</code>， 不能的话降级为 <code>MessageChannel</code>, 以上都不行的话就使用 <code>setTimeout</code>。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> setImmediate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;undefined&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isNative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(setImmediate)) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    macroTimerFunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      setImmediate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flushCallbacks)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MessageChannel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;undefined&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isNative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MessageChannel) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MessageChannel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;[object MessageChannelConstructor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> channel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MessageChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.port2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    channel.prot.onmessage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> flushCallbacks</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    macroTimerFunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      post.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    macroTimerFunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flushCallbacks, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span></code></pre></div><p><strong>总结</strong></p><p>以上就是 <code>Vue</code> 的 <code>nextTick</code> 方法的实现原理了，总结一下就是：</p><ul><li><code>vue</code> 用异步队列的方式来控制 <code>DOM</code> 更新和 <code>nextTick</code> 回调后执行；</li><li><code>microtask</code> 因为其高优先级特性，能确保队列中的微任务在一次事件循环前被执行完毕；</li><li>因为兼容性问题，<code>vue</code> 不得不做了 <code>microtask</code> 向 <code>macrotask</code> 的降级方案；</li></ul><p><strong>或者这么回答：</strong></p><p>原理就是使用宏任务或微任务来完成事件调用的机制，让自己的回调事件在一个 <code>eventloop</code> 的最后执行。宏任务或微任务根据浏览器情况采取不同的 <code>api</code>, 常见的 <code>macro task</code> 有 <code>setTimeout</code> 、<code>MessageChannel</code>、<code>postMessage</code>、<code>setImmediate</code>; 常见的 <code>micro task</code> 有 <code>MutationObserver</code> 和 <code>Promise.then</code>。</p><h2 id="_6-线程-进程-eventloop" tabindex="-1">6 线程，进程，EventLoop <a class="header-anchor" href="#_6-线程-进程-eventloop" aria-label="Permalink to &quot;6 线程，进程，EventLoop&quot;">​</a></h2><h3 id="线程与进程" tabindex="-1">线程与进程 <a class="header-anchor" href="#线程与进程" aria-label="Permalink to &quot;线程与进程&quot;">​</a></h3><p>我们经常说 JS 是单线程执行的，指的是一个进程里只有一个主线程。</p><p>那到底什么是线程？什么是进程？</p><p>官方的说法是：进程是 CPU 资源分配的最小单位；线程是 CPU 调度的最小单位。</p><ul><li>进程好比工厂，有单独专属于自己的工厂资源。</li><li>线程好比工人，多个工人在一个工厂协作。一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线。</li><li>工人们共享工厂的空间。进程的内存空间是共享的，每个线程都可以用这些共享内存。</li><li>多个工厂之间是独立存在的。</li></ul><h3 id="多进程与多线程" tabindex="-1">多进程与多线程 <a class="header-anchor" href="#多进程与多线程" aria-label="Permalink to &quot;多进程与多线程&quot;">​</a></h3><p><strong>多进程</strong></p><p>在同一个时间里，同一个计算机系统中如果允许两个或两个以上的进程处于运行状态。多进程带来的好处是明显的。比如你可以听歌词的同事打开编辑器敲代码，编辑器和听歌软件的进程之间丝毫不会相互干扰。</p><p><strong>多线程</strong></p><p>程序中包含多个执行流，即在一个程序中可以同时运行多个不同的线程来执行不同的任务。允许单个程序创建多个并行执行的线程来完成各自的任务。以 <code>chrome</code> 为例，当你打开一个 <code>tab</code> 页面时，其实就是创建了一个进程，一个进程中可以有多个线程，比如渲染线程，js 引擎线程， http 请求线程等等。当你发起一个请求时，其实就是创建了一个线程，当请求结束后，该线程可能就会被销毁。</p><h3 id="浏览器内核" tabindex="-1">浏览器内核 <a class="header-anchor" href="#浏览器内核" aria-label="Permalink to &quot;浏览器内核&quot;">​</a></h3><p>浏览器内核是多线程，在内核控制下各线程相互配合保持同步，一个浏览器通常由一下常驻线程组成：</p><ul><li>GUI 渲染线程</li><li>JavaScript 引擎线程</li><li>定时触发器线程</li><li>事件触发线程</li><li>异步 http 请求线程</li></ul><p><strong>GUI 渲染线程</strong></p><ul><li>主要负责页面的渲染，解析 <code>HTML</code>、<code>CSS</code>，构建 <code>DOM</code> 树， 布局和绘制等。</li><li>当界面需要重绘或者由于某种操作引发回流时，将执行该线程。</li><li>将线程与 JS 引擎线程互斥，当执行 JS 引擎线程时，GUI 渲染会被挂起，当任务队列闲空时，主线程才会去执行 GUI 渲染。</li></ul><p><strong>JavaScript 引擎线程</strong></p><ul><li>该线程当然是主要负责处理 <code>JavaScript</code> 脚本，执行代码。</li><li>也是主要负责执行准备好待执行的事件，即定时器计数结束，或者异步请求成功并正确返回时，将依次进入任务队列，等待 JS 引擎线程的执行。</li><li>当然，该线程与 GUI 渲染线程互斥，当 JS 引擎线程执行 <code>JavaScript</code> 脚本时间过长，将导致页面渲染的阻塞。</li></ul><p><strong>定时触发器线程</strong></p><ul><li>负责执行异步定时器一类的函数的线程，如：<code>setTimeout</code>, <code>setInterval</code>。</li><li>主线程依次执行代码时，遇到定时器，会将定时器交给该线程处理，当计数完毕后，事件触发线程会将计数完毕后的事件加入到任务队列的尾部，等待 JS 引擎线程执行。</li></ul><p><strong>事件触发进程</strong></p><ul><li>主要负责将准备好的事件交给 JS 引擎线程执行。 比如 <code>setTimeout</code> 定时器计数结束， <code>ajax</code> 等异步请求成功并触发回到函数，或者用户触发点击事件时，该线程会将整装待发的时候依次加入到任务队列的队尾，等待 JS 引擎线程的执行。</li></ul><p><strong>异步 http 请求线程</strong></p><ul><li>负责执行异步请求一类的函数的线程，如： <code>Promise</code>, <code>axios</code>, <code>ajax</code>等。</li><li>主线程依次执行代码时，遇到异步请求，会将函数交给该线程处理，当监听到状态码变更，如果有回调函数，事件触发线程会将回调函数加入到任务队列的尾部，等待 JS 引擎线程执行。</li></ul><h3 id="浏览器中的-event-loop-事件循环" tabindex="-1">浏览器中的 Event Loop(事件循环) <a class="header-anchor" href="#浏览器中的-event-loop-事件循环" aria-label="Permalink to &quot;浏览器中的 Event Loop(事件循环)&quot;">​</a></h3><p><strong>Micro-Task 与 Macro-Task</strong></p><p>浏览器端事件循环中的异步队列有两种：macro（宏任务）队列和 micro（微任务）队列。宏任务队列可以有多个，微任务队列只有一个。</p><ul><li>常见的 macro-task 比如：<code>setTimeout</code>、<code>setInterval</code>、<code>script</code> (整体代码)、<code>I/O</code> 操作、<code>UI</code> 渲染等。</li><li>常见的 micro-task 比如： <code>new Promise().then(回调)</code>、<code>MutationObserver</code> （html5 新特性）等。</li></ul><p>Event Loop 过程解析</p><p><img src="https://cdn.jsdelivr.net/gh/fqcto/images/blogs/picture/20211122174634.png" alt="Event Loop 过程解析"></p><ul><li>一开始执行栈空，我们可以把执行栈认为是一个存储函数调用的栈结构，遵循先进后出的原则。micro 队列空， macro 队列里有且只有一个 script 脚本（整体代码）。</li><li>全局上下文（script 标签）被推入执行栈，同步代码执行。在执行的过程中，会判断是同步任务还是异步任务，通过对一些接口的调用，可以产生新的 macro-task 与 micro-task，它们会分别被推入到各自的任务队列里。同步代码执行完了，script 脚本会被移除出 macro 队列，这个过程本质上是队列的 macro-task 的执行和出队的过程。</li><li>上一步我们出队的是一个 macro-task，这一步我们处理的是 micro-task。但需要注意的是：当 macro-task 出队时， 任务是一个一个执行的；而 micro-task 出队时，任务是一队一队执行的。因此。我们处理 micro 队列这一步，会逐个执行队列中的任务并把它出队，直到队列被清空。</li><li>执行渲染操作，更新界面。</li><li>检查是否存在 web workder 任务，如果有，则对其进行处理。</li><li>上述过程循环往复，直到两个队列都清空。</li></ul><p>我们总结一下，每一次循环都是一个这样的过程：</p><p><img src="https://cdn.jsdelivr.net/gh/fqcto/images/blogs/picture/20211122180125.png" alt="循环过程"></p><p>当某个宏任务执行完后，会查看是否有微任务队列。如果有，先执行微任务队列中的所有任务，如果没有，会读取宏任务队列中排在最前的任务，执行宏任务的过程中，遇到微任务，依次加入微任务队列。栈空后，再次读取微任务队列里的任务，以此类推。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Propmise1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;setTimeout2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;setTimeout1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Promise2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>最后输出结果是 <code>Promise1</code>, <code>setTimeout1</code>, <code>Promise2</code>, <code>setTimeout2</code></p><ul><li>一开始执行栈的同步任务（这属于宏任务）执行完毕，会去查看是否有微任务队列，上题中存在（有且只有一个），然后执行微任务队列中的所有任务输出 <code>Promise1</code>，同时会生成一个宏任务 <code>setTimeout2</code></li><li>然后去查看宏任务队列，宏任务 <code>setTimeout1</code> 在 <code>setTimeout2</code> 之前，先执行宏任务 <code>setTimeout1</code>，输出 <code>setTimeout1</code></li><li>在执行宏任务setTimeout1时会生成微任务 <code>Promise2</code>，加入微任务队列中，接着先去清空微任务队列中的所有任务，输出 <code>Promisee2</code></li><li>清空完微任务队列中的所有任务后，就又会去宏任务队列取一个，这回执行的是 <code>setTimeout2</code></li></ul><h2 id="_7-encode-decode-编码解码" tabindex="-1">7. encode/decode 编码解码 <a class="header-anchor" href="#_7-encode-decode-编码解码" aria-label="Permalink to &quot;7. encode/decode 编码解码&quot;">​</a></h2><p>一张图看懂 <code>encodeURI</code>、<code>encodeURIComponent</code>、<code>decodeURI</code>、<code>decodeURIComponent</code> 的区别</p><h3 id="这四个方法的用处" tabindex="-1">这四个方法的用处 <a class="header-anchor" href="#这四个方法的用处" aria-label="Permalink to &quot;这四个方法的用处&quot;">​</a></h3><h4 id="_1-用来编码和解码-uri-的" tabindex="-1">1.用来编码和解码 URI 的 <a class="header-anchor" href="#_1-用来编码和解码-uri-的" aria-label="Permalink to &quot;1.用来编码和解码 URI 的&quot;">​</a></h4><p>统一资源标识符，或叫做 <code>URI</code>， 是用来标识互联网上的资源（例如，网页或支付）和怎样访问这些资源的传输协议（例如，<code>HTTP</code> 和 <code>FTP</code>）的字符串。除了 <code>encodeURI</code>、<code>encodeURIComponent</code>、<code>decodeURI</code>、<code>decodeURIComponent</code> 四个字来编码和解码 <code>URI</code> 的函数之外 <code>ECMAScript</code> 语言自身不提供任何使用 <code>URL</code> 的支持。</p><h4 id="_2-uri组成形式" tabindex="-1">2.URI组成形式 <a class="header-anchor" href="#_2-uri组成形式" aria-label="Permalink to &quot;2.URI组成形式&quot;">​</a></h4><p>一个URI是由组件分隔符分割的组件序列组成，其一般形式：</p><p>Scheme : First / Second ; Third ? Fourth</p><p>其中斜体的名字代表组件； “:”, “/”, “;”，“?”是当作分隔符的保留字符；</p><h4 id="_3-有何不同" tabindex="-1">3.有何不同? <a class="header-anchor" href="#_3-有何不同" aria-label="Permalink to &quot;3.有何不同?&quot;">​</a></h4><p><code>encodeURI</code> 和 <code>decodeURI</code> 函数操作的是完整的 URI；这俩函数假定 URI 中的任何保留字符都有特殊意义，所有不会编码它们。</p><p><code>encodeURIComponent</code> 和 <code>decodeURIComponent</code> 函数操作的是组成 URI 的个别组件；这俩函数假定任何保留字符都代表普通文本，所以必须编码它们，所以它们（保留字符）出现在一个完整 URI 的组件里面时不会被解释成保留字符了。</p><p>以上说明摘自<a href="https://www.w3.org/html/ig/zh/wiki/ES5/%E6%A0%87%E5%87%86_ECMAScript_%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1#.E5.A4.84.E7.90.86_URI_.E7.9A.84.E5.87.BD.E6.95.B0.E5.B1.9E.E6.80.A7" target="_blank" rel="noreferrer">ECMAScript标准</a>，为了容易读懂做了点编辑加工。</p><h4 id="_4-图解四个函数的不同" tabindex="-1">4.图解四个函数的不同： <a class="header-anchor" href="#_4-图解四个函数的不同" aria-label="Permalink to &quot;4.图解四个函数的不同：&quot;">​</a></h4><p>ECMA对这四个函数还做了<a href="https://www.runoob.com/jsref/jsref-encodeuricomponent.html" target="_blank" rel="noreferrer">详细解释</a>，可能是为了写的更逻辑化一些，采用了类似变量配合逻辑的写法来说明，但是让初学者看得云里雾里的特别绕，所以有必要把它写得更像是人读的东西……</p><p><img src="https://cdn.jsdelivr.net/gh/fqcto/images/blogs/picture/20211213171202.png" alt="图解"></p><p>当 URI 里包含一个没在上面列出的字符或有时不想让给定的保留字符有特殊意义，那么必须编码这个字符。字符被转换成 UTF-8 编码，首先从 UT​​F-16 转换成相应的代码点值的替代。然后返回的字节序列转换为一个字符串，每个字节用一个“%xx”形式的转移序列表示。<a href="https://www.w3.org/html/ig/zh/wiki/ES5/%E6%A0%87%E5%87%86_ECMAScript_%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1#x15.1.3.1" target="_blank" rel="noreferrer">具体转换规则可以参考抽象操作Encode和Decode的说明</a></p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-09de1c0f><!--[--><!--]--><!----><nav class="prev-next" data-v-09de1c0f><div class="pager" data-v-09de1c0f><a class="VPLink link pager-link prev" href="/blogs/content/Concept/" data-v-09de1c0f><!--[--><span class="desc" data-v-09de1c0f>Previous page</span><span class="title" data-v-09de1c0f>概念详解</span><!--]--></a></div><div class="pager" data-v-09de1c0f><a class="VPLink link pager-link next" href="/blogs/content/Performance/" data-v-09de1c0f><!--[--><span class="desc" data-v-09de1c0f>Next page</span><span class="title" data-v-09de1c0f>性能优化</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"content_electron_index.md\":\"C5Myuo05\",\"content_http_index.md\":\"DtoXXRDZ\",\"content_concept_index.md\":\"CxP4TByP\",\"content_css_index.md\":\"DTXyoT6s\",\"content_performance_index.md\":\"DbjMBeed\",\"content_principle_index.md\":\"CY8QzGay\",\"content_problem_index.md\":\"CvY4zN40\",\"content_react_index.md\":\"DEQLBct4\",\"content_javascript_index.md\":\"CfDm1A1_\",\"content_source_index.md\":\"CzQ-woq0\",\"content_tools_picgo_index.md\":\"Dw40IsGj\",\"content_tools_btql_index.md\":\"CIJynykr\",\"content_tools_cicd_index.md\":\"D9p0_TdP\",\"content_source_vue_internal_index.md\":\"60ugP6EO\",\"content_operation_index.md\":\"CHlyILE4\",\"index.md\":\"B20w83yH\",\"guide_index.md\":\"DBUVXmQq\",\"content_source_javascript_index.md\":\"u85-uKH9\",\"content_source_vue_vue2_index.md\":\"Y8i0-9E5\",\"content_webpack_index.md\":\"DC0vJ59s\",\"content_vue_index.md\":\"B8iJjzlZ\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"blogs\",\"description\":\"专注于前端技术的总结，努力做一名知识的传播者\",\"base\":\"/blogs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"关于我\",\"items\":[{\"text\":\"组件库\",\"link\":\"https://canuse-ui.github.io/canuse\"}]}],\"sidebar\":[{\"text\":\"show all page\",\"items\":[{\"text\":\"Guide\",\"link\":\"/guide/\"},{\"text\":\"JavaScript\",\"link\":\"/content/JavaScript/\"},{\"text\":\"CSS\",\"link\":\"/content/Css/\"},{\"text\":\"Vue\",\"link\":\"/content/Vue/\"},{\"text\":\"React\",\"link\":\"/content/React/\"},{\"text\":\"Webpack\",\"link\":\"/content/Webpack/\"},{\"text\":\"Electron\",\"link\":\"/content/Electron/\"},{\"text\":\"HTTP\",\"link\":\"/content/Http/\"},{\"text\":\"概念详解\",\"link\":\"/content/Concept/\"},{\"text\":\"原理分析\",\"link\":\"/content/Principle/\"},{\"text\":\"性能优化\",\"link\":\"/content/Performance/\"},{\"text\":\"疑难杂症\",\"link\":\"/content/Problem/\"},{\"text\":\"源码\",\"items\":[{\"text\":\"Javascript\",\"link\":\"/content/Source/Javascript/\"},{\"text\":\"Vue2源码学习\",\"link\":\"/content/Source/Vue/Vue2/\"},{\"text\":\"vue内部运行机制\",\"link\":\"/content/Source/Vue/Internal/\"}]},{\"text\":\"工具\",\"items\":[{\"text\":\"PicGo图床\",\"link\":\"/content/Tools/Picgo/\"},{\"text\":\"CI/CD\",\"link\":\"/content/Tools/CICD/\"},{\"text\":\"宝塔面板+青龙面板\",\"link\":\"/content/Tools/BTQL/\"}]}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>